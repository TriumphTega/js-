# Wallet Setup Guide for Lunaris

## Overview

Lunaris integrates Solana blockchain wallets to allow users to receive and manage SOL tokens. The app uses **Solana Devnet** (test network) for development and testing.

## Network Configuration

**Current Network:** ‚úÖ **Devnet** (Testnet for development)

- **Devnet** is used for testing without using real SOL
- Devnet SOL can be obtained for free from faucets
- All transactions are on the test network only

**Location in code:** `dashboard.html:1362`
```javascript
const connection = new solanaWeb3.Connection(solanaWeb3.clusterApiUrl('devnet'));
```

## How Wallet Generation Works

### For Google Sign-In Users

1. When a user signs in with Google, a Solana wallet is **automatically created**
2. The wallet is stored in Firebase under `user-wallets/{userId}`
3. The wallet address is associated with the user's account
4. Users can view their wallet in the Dashboard ‚Üí Wallet button

### For Wallet Sign-In Users

1. Users connect with their existing wallet (Phantom, Solflare, Jupiter)
2. The wallet address becomes their user ID
3. No new wallet is generated - they use their existing wallet

## Wallet Features

### 1. View Wallet Address
- Click the "üëõ Wallet" button on the dashboard
- See your full Solana address
- Copy address to clipboard with one click

### 2. Check SOL Balance
- Displays current SOL balance on Devnet
- Click "üîÑ Refresh" to update balance
- Balance is fetched directly from Solana blockchain

### 3. Receive SOL
- Switch to "üì• Receive" tab
- View QR code for easy scanning
- Share your address to receive SOL tokens

### 4. Send SOL
- Switch to "üì§ Send" tab
- Enter recipient's Solana address
- Enter amount to send
- **Note:** Sending requires a connected Phantom wallet (not auto-generated wallets)

## Generate Wallet Button

If you don't have a wallet yet, you'll see a "üîë Generate Solana Wallet" button.

**When it appears:**
- New users who haven't had a wallet created yet
- Users whose wallet creation failed previously

**What it does:**
1. Creates a new Solana keypair (public + private key)
2. Stores the wallet securely in Firebase
3. Associates the wallet with your account
4. Displays your new wallet address

**Location in code:** `dashboard.html:1304-1357`

## Security Notes

‚ö†Ô∏è **IMPORTANT - For Development Only:**

1. **Private keys are stored in Firebase** for convenience during development
2. **This is NOT secure for production use** - private keys should NEVER be stored in plain text
3. For production, you should:
   - Use proper encryption for private keys
   - Or better yet: Only store public keys and let users manage their own private keys
   - Integrate with hardware wallets or proper key management systems

## Getting Devnet SOL

To test wallet functionality, you need Devnet SOL:

### Method 1: Solana Faucet
1. Go to https://faucet.solana.com/
2. Enter your wallet address (copy from Lunaris wallet modal)
3. Select "Devnet"
4. Click "Request Airdrop"
5. You'll receive 1-2 SOL on Devnet

### Method 2: Command Line (if you have Solana CLI)
```bash
solana airdrop 2 <YOUR_WALLET_ADDRESS> --url devnet
```

### Method 3: Phantom Wallet
1. Open Phantom wallet extension
2. Go to Settings ‚Üí Developer Settings
3. Switch to "Devnet"
4. Click "Airdrop SOL"

## Switching to Mainnet (Production)

‚ö†Ô∏è **DO NOT switch to mainnet without proper security measures!**

When ready for production:

1. **Secure private key storage:**
   - Implement proper encryption
   - Use a key management service
   - Or remove private key storage entirely

2. **Update network in code:**
   ```javascript
   // Change from:
   const connection = new solanaWeb3.Connection(solanaWeb3.clusterApiUrl('devnet'));

   // To:
   const connection = new solanaWeb3.Connection(solanaWeb3.clusterApiUrl('mainnet-beta'));
   ```

3. **Test thoroughly:**
   - Test all wallet operations on devnet first
   - Test with small amounts on mainnet
   - Implement proper error handling

4. **Update UI:**
   - Add warnings about real money
   - Add transaction confirmations
   - Display network status clearly

## Troubleshooting

### "No wallet found" error
- Sign out and sign in again
- Click "Generate Wallet" button if it appears
- Check Firebase Database for `user-wallets/{your-uid}`

### Balance shows 0.00
- You're on Devnet - request an airdrop (see above)
- Click "Refresh" button to update
- Check you're connected to the right network

### Can't send SOL
- App-generated wallets can only receive (for security)
- To send, connect with Phantom wallet
- Make sure you have enough SOL for transaction fees

### QR Code not showing
- Check internet connection (QR is generated by external API)
- Reload the page
- Check browser console for errors

## Technical Details

### Wallet Storage Structure

Firebase Database path: `user-wallets/{userId}`

```json
{
  "address": "AbC123...xyz789",
  "privateKey": "base64EncodedPrivateKey",
  "createdAt": 1234567890,
  "type": "generated"
}
```

### Supported Wallets

For wallet sign-in (not auto-generated):
- ‚úÖ **Phantom** - Most popular Solana wallet
- ‚úÖ **Solflare** - Feature-rich Solana wallet
- ‚úÖ **Jupiter** - Trading-focused wallet
- üöß **WalletConnect** - Coming soon

## API Endpoints Used

- **Solana RPC:** `https://api.devnet.solana.com`
- **QR Code:** `https://api.qrserver.com/v1/create-qr-code/`

## Files Involved

- `dashboard.html:1227-1460` - Wallet modal and functionality
- `index.html:184-215` - Wallet creation on Google sign-in
- `index.html:370-408` - Wallet connection for wallet sign-in

## Future Enhancements

Planned features:
- [ ] Token balance display (SPL tokens)
- [ ] Transaction history
- [ ] Multi-wallet support
- [ ] NFT display
- [ ] Staking integration
- [ ] Hardware wallet support
